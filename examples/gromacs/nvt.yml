steps:
  - grompp:
      in:
        config: '{"mdp": {"integrator":"sd", "rvdw":"1.0", "rcoulomb":"1.0", "coulombtype":"pme", "nsteps":"10000", "dt":0.002, "tc-grps":"system", "ref-t":"498", "tau-t":"2", "constraints":"h-bonds", "nstxout":"1000", "nstenergy":"10", "define":"-DPOSRES", "comm-mode":"linear", "comm-grps":"system"}}'
  - mdrun:
      in:
        output_edr_path: 'nvt.edr'
        #config: '{"use_gpu": "True"}'
  - gmx_energy:
      in:
        config: '{"terms":  ["Temperature"]}'
        output_xvg_path: 'temperature.xvg'
  - cwl_watcher:
      in:
        #cachedir_path: /absolute/path/to/cachedir/ (automatically filled in by wic)
        file_pattern: ' *nvt.edr'
        cwl_tool: gmx_energy
        max_times: '5'
        config: '{"in": {"input_energy_path": "nvt.edr", "config": "{\"terms\":  [\"Temperature\"]}", "output_xvg_path": "temperature.xvg"}}'

wic:
  graphviz:
    label: Constant\nVolume
  steps:
    (1, grompp):
      wic:
        graphviz:
          label: 'Update\nTopology'
    (2, mdrun):
      wic:
        graphviz:
          label: 'Molecular\nDynamics'
    (3, gmx_energy):
      wic:
        graphviz:
          label: 'Analyze & Plot\nTemperature\nTimeseries'
    (4, cwl_watcher):
      wic:
        graphviz:
          label: 'Real-time\nAnalysis'
          style: invis # Make this node invisible
