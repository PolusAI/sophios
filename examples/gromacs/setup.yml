steps:
- pdb:
    in:
      output_pdb_path: xray.pdb
      #config: '{"pdb_code": "1aki"}' # from tutorial
      config: '{"pdb_code": "1enh"}' # from https://pubs.acs.org/doi/10.1021/acs.jpcb.8b02144
- fix_side_chain:
- pdb2gmx:
- editconf:
    in:
      config: '{"box_type": "cubic", "distance_to_molecule": 1.0}'
- solvate:
- grompp:
    in:
      config: '{"mdp": {"integrator": "steep"}}'
- genion:
    in:
      config: '{"neutral": "True"}'
      output_top_zip_path: '&genion.top'

wic:
  graphviz:
    label: System Setup
    ranksame:
    - (1, pdb)
    - (7, genion)
  steps:
    (1, pdb):
      wic:
        graphviz:
          label: 'Download\nPDB Code'
    (2, fix_side_chain):
      wic:
        graphviz:
          label: 'Fix Side Chain'
    (3, pdb2gmx):
      wic:
        graphviz:
          label: 'Generate\nInitial\nTopology'
    (4, editconf):
      wic:
        graphviz:
          label: 'Initialize\nPeriodic Box'
    (5, solvate):
      wic:
        graphviz:
          label: 'Add Water\nSolvent'
    (6, grompp):
      wic:
        graphviz:
          label: 'Update\nTopology'
    (7, genion):
      wic:
        graphviz:
          label: 'Neutralize &\nAdd Ions'