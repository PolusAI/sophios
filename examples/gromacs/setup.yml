steps:
- pdb2gmx:
    in:
      config: '{"water_type": "spce", "force_field": "amber99sb-ildn", "ignh": "False", "merge": "False"}'
- editconf:
    in:
      config: '{"box_type": "cubic", "distance_to_molecule": 1.6}'
- solvate:
- grompp:
    in:
      config: '{"mdp": {"integrator": "steep"}}'
- genion:
    in:
      # pH 7.0 = 0.05 concentration, pH 3.6 = 1.50 concentration, pH 2.5 = 4.50 concentration
      # NOTE: At higher salt concentrations, you may need to increase nsteps of
      # steepest descent minimization from 200 to around 300.
      config: '{"neutral": "True", "concentration": 0.05}' # mol/liter 
      output_top_zip_path: '&genion.top'

wic:
  graphviz:
    label: System Setup
    ranksame:
    - (1, pdb2gmx)
    - (5, genion)
  steps:
    (1, pdb2gmx):
      wic:
        graphviz:
          label: 'Generate\nInitial\nTopology'
    (2, editconf):
      wic:
        graphviz:
          label: 'Initialize\nPeriodic Box'
    (3, solvate):
      wic:
        graphviz:
          label: 'Add Water\nSolvent'
    (4, grompp):
      wic:
        graphviz:
          label: 'Update\nTopology'
    (5, genion):
      wic:
        graphviz:
          label: 'Neutralize &\nAdd Ions'